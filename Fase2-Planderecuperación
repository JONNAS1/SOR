#Para crear nuestro nuevo dominio, hacemos uso del siguiente comando:
Install-ADDSForest -DatabasePath "C:\Windows\NTDS" -LogPath "C:\Windows\NTDS" -SYSVOLPath "C:\Windows\SYSVOL" -DomainName "edu-gva.es" -DomainNetBIOSName "dominio" -ForestMode "Win2012" -InstallDNS:$true -NoRebootOnCompletion:$false -Force:$true

#Para crear un nuevo dominio secundario llamado Repl.iescaminas en el bosque llamado edu-gva.es y que el sistema pida especificar y confirmar una contraseña enmascarada, usamos el sguiente comnado:
Install-ADDSDomain "NewDomainName Repl.iescaminas "ParentDomainName edu-gva.es "DomainType Child

#Para instalar el servidor DNS, desde PowerShell usamos el siguiente comando:
Install-WindowsFeature -Name DNS -IncludeAllSubFeature -IncludeManagementTools -Restart

#Para instalar el módulo de Active Directory en PowerShell, usamos el siguiente comando:
Install-WindowsFeature -Name RSAT-AD-PowerShell -IncludeAllSubfeature -IncludeManagementTools -Restart


##
# Install-ADDSForest -DatabasePath "C:\Windows\NTDS" -LogPath "C:\Windows\NTDS" -SYSVOLPath "C:\Windows\SYSVOL" -DomainName "dominio.local" -DomainNetBIOSName "dominio" -ForestMode "Win2012" -InstallDNS:$true -NoRebootOnCompletion:$false -Force:$trueScript de WindowsPowershell para la implementación de AD DS
#

Import-Module ADDSDeployment 
Install-ADDSForest `
-CreateDnsDelegation:$false `
-DatabasePath "C:\Window\NTDS" `
-DomainMode "WinThreshold" `
-DomainNetbiosName "EDU-GVA" `
-ForestMode "WinThreshold" `
-InstallDns:$true `
-LogPath  "C\Windows\NTDS" `
-NoRebooOCompletion:$false ` 
-SysvolPath "C:\WindowsªSYSVOL" `
-Force:$true

#Implewmentación del dominio secundario al bosque existenete:
Install-AddsDomain
-domaintype <{childdomain | treedomain}>
-parentdomainname <edu-gva.es>
-newdomainname <Repl.iescaminas>
-credential <pscredential>


#Primero se pone el ps1 y después el csv.
#Para crear nuevos equipos (escribimos todo en csv) , usamos el sigiente comando:
Computer:Path
W10HG-1:"OU=equipos,OU=departamentos,dc=""caminas"",dc=""edu-gva"",dc=""es"""

#Para iniciar a crear nuevos equipos (creamos y escribimos esto en un archivo ps1), usamos el sigiente comando:
$dc="dc=caminas,dc=edu-gva,dc=es"
$equiposCsv=Read-Host "Introduce el fichero csv de Equipos"
$fichero= import-csv -Path $equiposcsv -delimiter ":"

foreach($linea in $fichero)
{
New-ADComputer -Enabled:$true -Name:$linea.Computer -Path:$linea.Path -SamAccountName:$linea.Computer
}
